---
const { lang = 'en', title = 'Bubble Burst Clock' } = Astro.props;

const companies = [
  {
    name: 'google',
    color: 'rgba(66, 133, 244, 0.3)',
    logo: `<svg viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.21-1.19-2.63z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>`
  },
  {
    name: 'openai',
    color: 'rgba(16, 163, 127, 0.3)',
    logo: `<svg viewBox="0 0 24 24" fill="#FFFFFF"><path d="M22.28 9.82a5.98 5.98 0 0 0-.51-4.91 6.04 6.04 0 0 0-6.51-2.9A6.06 6.06 0 0 0 9.53 2a6.03 6.03 0 0 0-5.42 3.24 5.98 5.98 0 0 0-.52 4.91A6.04 6.04 0 0 0 2.92 13.05a6.06 6.06 0 0 0 5.73 4.01 6.03 6.03 0 0 0 5.42-3.24 5.98 5.98 0 0 0 .52-4.91 6.04 6.04 0 0 0 6.51 2.9 6.06 6.06 0 0 0-5.73-4.01ZM9.53 3.6a4.43 4.43 0 0 1 4.03 2.38l.45.78-2.92 1.69-1.55-2.68a2.22 2.22 0 0 0-2.31-1.08l-.16.03.92-1.59a4.46 4.46 0 0 1 1.55.47ZM4.95 4.64a4.43 4.43 0 0 1 2.32 4v.9l-3.38 1.95V6.86a2.22 2.22 0 0 0-.82-1.92l-.12-.09 1.59-.92a4.46 4.46 0 0 1 1.4-.29ZM2.15 10.98a4.43 4.43 0 0 1 2.32-4l.78-.45-1.69-2.93-1.55 2.68a2.22 2.22 0 0 0 .38 2.52l.1.1-1.59.92a4.46 4.46 0 0 1-1.99-1.56Zm4.03 6.88a4.43 4.43 0 0 1-4.03-2.38l-.45-.78 2.92-1.69 1.55 2.68a2.22 2.22 0 0 0 2.31 1.08l.16-.03-.92 1.59a4.46 4.46 0 0 1-1.55-.47Zm8.61-1.04a4.43 4.43 0 0 1-2.32 4v-.9l3.38-1.95v4.62a2.22 2.22 0 0 0 .82 1.92l.12.09-1.59.92a4.46 4.46 0 0 1-1.41-1.3Zm2.79-6.34a4.43 4.43 0 0 1-2.31 4l-.78.45 1.69 2.92 2.68-1.55a2.22 2.22 0 0 0-.38-2.52l-.1-.1 1.59-.92a4.46 4.46 0 0 1 1.99 1.56Z"/></svg>`
  },
  {
    name: 'anthropic',
    color: 'rgba(215, 206, 190, 0.3)',
    logo: `<svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M9.218 2h2.402L16 12.987h-2.402zM4.379 2h2.512l4.38 10.987H8.82l-.895-2.308h-4.58l-.896 2.307H0L4.38 2.001zm2.755 6.64L5.635 4.777 4.137 8.64z"/></svg>`
  },
  {
    name: 'meta',
    color: 'rgba(6, 104, 225, 0.3)',
    logo: `<svg viewBox="0 0 24 24" fill="#0668E1"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>` // Simplified circle/loop placeholder as requested for robustness
  },
  {
    name: 'xai',
    color: 'rgba(255, 255, 255, 0.2)',
    logo: `<svg viewBox="0 0 24 24" fill="currentColor"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="14" font-weight="bold" fill="white">X.AI</text></svg>`
  },
  {
    name: 'mistral',
    color: 'rgba(253, 186, 116, 0.3)',
    logo: `<svg viewBox="0 0 24 24" fill="currentColor"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="16" font-weight="bold" fill="#FDBA74">M</text></svg>`
  },
  {
    name: 'deepseek',
    color: 'rgba(59, 130, 246, 0.3)',
    logo: `<svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="10" fill="#3B82F6" opacity="0.5"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="10" font-weight="bold" fill="white">DS</text></svg>`
  }
];

// Generate 12 bubbles (some companies repeated)
const bubbles = [
    { ...companies[0], size: '60px', left: '10%', duration: '18s', delay: '0s' }, // Google
    { ...companies[1], size: '50px', left: '25%', duration: '15s', delay: '2s' }, // OpenAI
    { ...companies[2], size: '70px', left: '40%', duration: '20s', delay: '5s' }, // Anthropic
    { ...companies[3], size: '55px', left: '60%', duration: '17s', delay: '1s' }, // Meta
    { ...companies[4], size: '45px', left: '75%', duration: '14s', delay: '3s' }, // xAI
    { ...companies[5], size: '65px', left: '90%', duration: '19s', delay: '6s' }, // Mistral
    { ...companies[6], size: '50px', left: '15%', duration: '16s', delay: '8s' }, // DeepSeek
    { ...companies[0], size: '40px', left: '35%', duration: '22s', delay: '10s' }, // Google
    { ...companies[1], size: '55px', left: '55%', duration: '13s', delay: '4s' }, // OpenAI
    { ...companies[2], size: '60px', left: '80%', duration: '21s', delay: '7s' }, // Anthropic
    { ...companies[4], size: '50px', left: '5%', duration: '25s', delay: '12s' }, // xAI
    { ...companies[3], size: '45px', left: '50%', duration: '19s', delay: '9s' }, // Meta
];
---
<!doctype html>
<html lang={lang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@600;700;900&display=swap" rel="stylesheet">
		<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5230972214569734"
     crossorigin="anonymous"></script>
        <slot name="head" />
	</head>
	<body>
        <div class="background-bubbles">
            {bubbles.map((b, i) => (
                <div
                    class="bubble"
                    data-index={i}
                    style={{
                        '--bubble-color': b.color,
                        width: b.size,
                        height: b.size,
                        left: b.left,
                        animationDuration: b.duration,
                        animationDelay: b.delay
                    }}
                    set:html={b.logo}
                />
            ))}
        </div>
		<div class="content-wrapper">
            <slot />
        </div>

        <script>
            function createParticles(x, y, color) {
                const particleCount = 12;
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('bubble-particle');

                    const angle = Math.random() * Math.PI * 2;
                    const velocity = 2 + Math.random() * 2;
                    const tx = Math.cos(angle) * velocity * 50; // Distance
                    const ty = Math.sin(angle) * velocity * 50;

                    particle.style.left = `${x}px`;
                    particle.style.top = `${y}px`;
                    particle.style.backgroundColor = color || 'white';
                    particle.style.setProperty('--tx', `${tx}px`);
                    particle.style.setProperty('--ty', `${ty}px`);

                    document.body.appendChild(particle);

                    // Cleanup
                    setTimeout(() => {
                        particle.remove();
                    }, 1000);
                }
            }

            document.addEventListener('DOMContentLoaded', () => {
                const bubbles = document.querySelectorAll('.bubble');
                bubbles.forEach(bubble => {
                    bubble.addEventListener('click', (e) => {
                        const rect = bubble.getBoundingClientRect();
                        const centerX = rect.left + rect.width / 2;
                        const centerY = rect.top + rect.height / 2;
                        // Get color from inline style or computed style
                        // Actually easier to just default to white or extract it
                        // We can't easily get the specific logo color, but we can use the bubble background color
                        // which is set as a var.
                        // However, inline styles on element: bubble.style.getPropertyValue('--bubble-color')
                        const color = bubble.style.getPropertyValue('--bubble-color') || 'white';

                        createParticles(centerX, centerY, color);

                        // "Pop" effect
                        bubble.classList.add('popped');

                        // Respawn after a delay
                        setTimeout(() => {
                            bubble.classList.remove('popped');
                            // Optional: randomize position slightly?
                            // For now just re-appearing is fine as it simulates a new bubble rising
                        }, 5000); // 5 seconds of hiding
                    });
                });
            });
        </script>
	</body>
</html>

<style is:global>
    :root {
        --font-body: 'Inter', sans-serif;
        --font-heading: 'Poppins', sans-serif;
        --color-bg: #111827;
        --color-text: #F3F4F6;
    }

	html,
	body {
		margin: 0;
		width: 100%;
        min-height: 100vh;
        background-color: var(--color-bg);
        color: var(--color-text);
        font-family: var(--font-body);
        overflow-x: hidden;
	}

    h1, h2, h3, h4, h5, h6 {
        font-family: var(--font-heading);
    }

    .content-wrapper {
        position: relative;
        z-index: 1;
    }

    /* Bubbles Background */
    .background-bubbles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
        overflow: hidden;
        /* Allow clicks on bubbles */
        pointer-events: none;
    }

    .bubble {
        position: absolute;
        bottom: -100px;
        background-color: var(--bubble-color, rgba(255, 255, 255, 0.1));
        border-radius: 50%;
        animation: rise linear infinite; /* changed ease-in to linear for smoother flow */
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        pointer-events: auto; /* Enable clicks specifically on bubbles */
        transition: transform 0.2s, opacity 0.2s;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(2px);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .bubble svg {
        width: 60%;
        height: 60%;
        opacity: 0.8;
    }

    .bubble:hover {
        transform: scale(1.1);
        opacity: 1 !important;
    }

    .bubble.popped {
        opacity: 0 !important;
        pointer-events: none;
        transition: opacity 0.1s;
    }

    /* Particle Animation */
    .bubble-particle {
        position: fixed;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        pointer-events: none;
        z-index: 10;
        animation: particle-burst 0.8s forwards ease-out;
    }

    @keyframes particle-burst {
        0% {
            transform: translate(0, 0) scale(1);
            opacity: 1;
        }
        100% {
            transform: translate(var(--tx), var(--ty)) scale(0);
            opacity: 0;
        }
    }

    @keyframes rise {
        0% {
            bottom: -120px;
            transform: translateX(0) rotate(0deg);
        }
        50% {
            transform: translateX(100px) rotate(180deg);
        }
        100% {
            bottom: 120%; /* Move completely off screen */
            transform: translateX(-100px) rotate(360deg);
        }
    }
</style>
